<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
		<title>STCU Jeans Day</title>
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine:bold">
		<link rel="stylesheet" type="text/css" href="bx_styles/bx_styles.css" />
		<link rel="stylesheet" type="text/css" href="css/styles.css" />
		<script src="js/jquery.min.js" type="text/javascript" ></script>
		<script src="js/jquery.bxSlider.min.js" type="text/javascript" ></script>
		<script src="js/jquery.backgroundCanvas.js" type="text/javascript" ></script>
		<script src="js/jquery.mseitUtilities.js" type="text/javascript" ></script>
		<!--[if IE]>
		<script src="js/excanvas.min.js" type="text/javascript" ></script>
		<![endif]-->
		<script type="text/javascript" language="javascript" charset="utf-8">
			// <![CDATA[
				
		var jeanDates;
		var currentDate;

		$(document).ready( function() {
			   $.ajax({
			      type: "get",
			      url: "jeansdays.json",
			      dataType: "json",
			      success: function(data) { setDates(data); },
				  error: function() { $('.date').html('Sorry, could not make it happen'); }
			    });

				$(".sliderWrapper").backgroundCanvas();

				$('#slider').bxSlider({
					speed: 1000,
					onNextSlide: function(currentSlideNumber) {
						currentDate.setDate((currentDate.getDate()+1));
						setAnswer(3);
						setDay(3);
						setAnswer(currentSlideNumber + 1);
						setDay(currentSlideNumber + 1);
					},
					onPrevSlide: function(currentSlideNumber) {
						currentDate.setDate((currentDate.getDate()-1));
						setAnswer(0);
						setDay(0);
						setAnswer(currentSlideNumber + 1);
						setDay(currentSlideNumber + 1);
					}
				});
		});

function setDates(dates) {
	jeanDates = new Array();
	for (var entry in dates) {
		var items = dates[entry].split(':');
		jeanDates[items[1]] = items[0];
	}

	currentDate = new Date();
	setAnswer(1);
	setDay(1);
}

function setAnswer(index) {
	var key = currentDate.getFullYear() + '-' + padDateNumber(currentDate.getMonth() +1) + '-' + padDateNumber(currentDate.getDate());
	var answer; var title;
	if (jeanDates[key] == undefined) {
		answer = "No"; title = "";
	} else {
		answer = "Yes"; title = jeanDates[key];
	}
	$('.answer:eq(' + index + ')').html(answer);
	$('.title:eq(' + index + ')').html(title);
}

function padDateNumber(dateNumber) {
	return dateNumber < 9 ? '0' + dateNumber : dateNumber;
}

function setDay(index) {
	$('.date:eq(' + index + ')').html(getDayName(currentDate.getDay()) + ' ' + getMonthName(currentDate.getMonth()) + ' ' + currentDate.getDate() + ', ' + currentDate.getFullYear());
}

function getDayName(dayNumber) {
	if (dayNumber == 0) return "Sunday";
	if (dayNumber == 1) return "Monday";
	if (dayNumber == 2) return "Tuesday";
	if (dayNumber == 3) return "Wednesday";
	if (dayNumber == 4) return "Thursday";
	if (dayNumber == 5) return "Friday";
	if (dayNumber == 6) return "Saturday";
	return "";
}

function getMonthName(monthNumber) {
	if (monthNumber == 0) return "January";
	if (monthNumber == 1) return "February";
	if (monthNumber == 2) return "March";
	if (monthNumber == 3) return "April";
	if (monthNumber == 4) return "May";
	if (monthNumber == 5) return "June";
	if (monthNumber == 6) return "July";
	if (monthNumber == 7) return "August";
	if (monthNumber == 8) return "September";
	if (monthNumber == 9) return "October";
	if (monthNumber == 10) return "November";
	if (monthNumber == 11) return "December";
	return "";
}

function DrawBackground() {
	$(".sliderWrapper").backgroundCanvasPaint(BackgroundPaintFkt);
}

$(window).load(function () { DrawBackground(); });
$(window).resize(function() { DrawBackground(); });

function BackgroundPaintFkt(context, width, height, elementInfo)
{
	var options = {x:0, height: height, width: width, radius:14, border: 0 };

	// Draw the border rectangle
	context.fillStyle = "#ccc";
	$.canvasPaint.roundedRect(context,options);

	// Draw the gradient filled inner rectangle
	var backgroundGradient = context.createLinearGradient(0, 0, 0, height - 10);
	backgroundGradient.addColorStop(0 ,'#fff');
	backgroundGradient.addColorStop(1, '#eee');
	options.border = 1;
	context.fillStyle = backgroundGradient;
	$.canvasPaint.roundedRect(context,options);
}


				// ]]>
			</script>
			
	</head>
	<body>

		<div class="sliderWrapper">
			<ul id="slider" class="sliderItems">
				<li>
					<p class="date">Loading...</p>
					<p class="answer"></p>
					<p class="title"></p>
				</li>
				<li>
					<p class="date"></p>
					<p class="answer"></p>
					<p class="title"></p>
				</li>
			</ul>
		</div>
	</body>
</html>
